{% extends "base.html" %}

{% block title %}USB Partition Mounting{% endblock %}

{% block content %}
<!-- Link to local Bootstrap CSS -->
<link rel="stylesheet" href="/bootstrap-5.3.3-dist/css/bootstrap.min.css">

<style>
    /* Container for the entire form */
    .form-container {
        max-width: 600px; /* Adjust width for mobile optimization */
        margin: 2rem auto;
        padding: 1rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: var(--form-bg, #f9f9f9); /* Adjust background color variable */
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); /* Soft shadow */
    }

    /* Heading style */
    h1 {
        text-align: center;
        margin-bottom: 1rem;
        font-size: 1.5rem; /* Larger font size */
        font-weight: 600;
        color: var(--heading-color, #333); /* Adjust heading color variable */
        background-color: var(--heading-bg, #fff); /* Adjust background color variable */
        padding: 0.5rem; /* Padding around the heading */
        border-radius: 8px; /* Rounded corners for the heading */
        box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    }

    /* Form fields styling */
    .form-select {
        font-size: 1.1rem; /* Slightly larger select text for better readability */
        width: 100%;
    }

    button {
        width: 100%;
        padding: 12px;
        font-size: 1.2rem; /* Larger button text */
    }

    /* Spacing between label and input */
    .form-group {
        display: table;
        width: 100%;
        margin-bottom: 1.5rem;
    }

    .form-group label {
        display: table-cell;
        width: 40%; /* Labels take up 40% of the width */
        font-size: 1rem;
        padding-right: 10px; /* Space between label and input */
        color: var(--label-color, #333); /* Adjust label color variable */
    }

    .form-group select {
        display: table-cell;
        width: 60%; /* Select elements take up the remaining space */
        font-size: 1.1rem;
    }

    /* Mobile-specific adjustments */
    @media (max-width: 576px) {
        h1 {
            font-size: 1.2rem; /* Smaller title for smaller screens */
        }

        .form-container {
            padding: 1rem; /* Adjust padding for smaller screens */
        }

        .form-select {
            font-size: 1rem; /* Adjust select dropdown font */
            width: 100%;
        }

        button {
            font-size: 1.1rem; /* Slightly smaller button font */
            padding: 10px; /* More compact button */
        }
    }

    /* Disabled button styling */
    .disabled-button {
        pointer-events: none;
        background-color: #6c757d; /* Grayed-out color */
    }

    /* Dark mode styles */
    body.dark-mode .form-container {
        background-color: #333; /* Dark background color for form */
    }

    body.dark-mode h1 {
        color: #f0f0f0; /* Light color for heading text */
        background-color: #444; /* Dark background for heading */
    }

    body.dark-mode .form-group label {
        color: #f0f0f0; /* Light color for labels */
    }

    body.dark-mode button {
        background-color: #555; /* Dark background color for button */
        color: #f0f0f0; /* Light color for button text */
    }
</style>

<script src="/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
<script>
    function updateOptions() {
        const source = document.getElementById("source");
        const destination = document.getElementById("destination");
        const sourceValue = source.value;
        const destinationValue = destination.value;

        // Enable all options initially
        for (let option of source.options) {
            option.disabled = false;
        }
        for (let option of destination.options) {
            option.disabled = false;
        }

        // Disable conflicting options
        if (sourceValue) {
            for (let option of destination.options) {
                if (option.value === sourceValue) {
                    option.disabled = true;
                }
            }
        }
        if (destinationValue) {
            for (let option of source.options) {
                if (option.value === destinationValue) {
                    option.disabled = true;
                }
            }
        }
    }

    function disableButton() {
        const button = document.getElementById("mountButton");
        button.innerHTML = "Loading Disks..."; // Change button text
        button.classList.add("disabled-button"); // Disable the button
    }
</script>

<div class="form-container">
    <h1>USB Partition Mounting</h1>
    <form method="POST" action="/mount" onsubmit="disableButton()">
        <div class="form-group">
            <label for="source" class="form-label">Source Disk:</label>
        <select id="source" name="source" class="form-select" required onchange="updateOptions()">
    <option value="">Select Disk</option>
    {% for partition in partitions %}
        <option value="{{ partition.name }}">
            {% if partition.label %}
                {{ partition.label }} ({{ partition.size }})
            {% else %}
                {{ partition.name }} - {{ partition.size }}
            {% endif %}
        </option>
    {% endfor %}
</select>
        </div>

        <div class="form-group">
            <label for="destination" class="form-label">Destination Disk:</label>
        <select id="destination" name="destination" class="form-select" required onchange="updateOptions()">
    <option value="">Select Disk</option>
    {% for partition in partitions %}
        <option value="{{ partition.name }}">
            {% if partition.label %}
                {{ partition.label }} ({{ partition.size }})
            {% else %}
                {{ partition.name }} - {{ partition.size }}
            {% endif %}
        </option>
    {% endfor %}
</select>
        </div>

        <button id="mountButton" type="submit" class="btn btn-primary">Load Disks</button>
    </form>
</div>
{% endblock %}
